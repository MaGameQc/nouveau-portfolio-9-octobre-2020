<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tommy Audet</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Palanquin+Dark&display=swap" rel="stylesheet">
    <!-- font awesome -->
    <script src="https://kit.fontawesome.com/605bf599b1.js" crossorigin="anonymous"></script>
</head>
<body id="main">

    <div id="background">

    </div>

    <div id="smokeOverlay">
       <!-- <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt="">
       <img class="smoke" src="image/smoke.png" alt=""> -->

       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>
       <div class="smokeTest">
        <img class="smoke" src="image/smoke.png" alt="">
       </div>





        <!-- <div class="test"></div> -->
    </div>

    <nav id="navbarContainer">
        <p>Tommy Audet</p>
        <a id="allProjects" href="">Voir tout les projets</a>
    </nav>
    
    <div id="contentContainer">
        <div id="btnContainer">
            <i id="up" class="fas fa-angle-up"></i>
            <i id="down" class="fas fa-angle-down"></i>
        </div>
        <div id="informationContainer">
            <ul id="listOfContent">
                <li>
                    <a href="">
                        <p class="contentDescription">Programmeur Web Front-End</p>
                        <p class="contentTitle">Tommy Audet</p>
                    </a>
                </li>
            </ul>
        </div>
        <div id="indexContainer">

            <ul id="lineList">
                <li>
                    <p class="lineState"></p>
                    <span class="line"></span>
                </li>
                <li>
                    <p class="lineState"></p>
                    <span class="line"></span>
                </li>
                <li>
                    <p class="lineState"></p>
                    <span class="line"></span>
                </li>
                <li>
                    <p class="lineState"></p>
                    <span class="line"></span>
                </li>
            </ul>
            
        </div>
    </div>

    <div id="footerContainer">

    </div>

    <script>

let bg = {
    indx : 0,
    savedIndex : 0,
    Container : document.getElementById("background"), 
    Url : document.getElementById("background").style,
    smokeOverlay : document.querySelector("#smokeOverlay"),
    smokeOverlayImg : document.querySelectorAll(".smokeTest"),
    ImgNames : ["background1.jpg", "background2.jpg", "background3.jpg", "background4.jpg"],
    navList : document.querySelectorAll("#lineList li"),
    navSpanLines : document.querySelectorAll("#lineList li span"),
    navLineState : document.querySelectorAll(".lineState"),
    arrowUp : document.querySelector("#up"),
    arrowDown : document.querySelector("#down"),

    initialiseListenners : function(){
        this.addWheelListenner();
        this.addNavIndexListenners();
        this.addArrowListenners();
    },

    addWheelListenner : function(){
        document.onwheel = (e) =>{
            let isScrollingDown;
            if(e.deltaY > 0){
                isScrollingDown = true;
                this.deselectLastElement();
                this.indx ++
                this.savedIndex = this.indx;
                this.showSmoke();
                if(this.indx > this.ImgNames.length -1){
                    this.indx = 0;
                    this.savedIndex = this.indx;
                }
                this.selectThisElement();
            } else{
                isScrollingDown = false;
                this.deselectLastElement();
                this.indx --
                this.savedIndex = this.indx;
                this.showSmoke();
                if(this.indx < 0){
                    this.indx = this.ImgNames.length -1;
                    this.savedIndex = this.indx;
                }
                this.selectThisElement();
            }
            


            this.changeBgImage();

        }
    },

    addArrowListenners : function(){
        let self = bg;
        self.arrowUp.addEventListener("click", function(){
            self.deselectLastElement();
            self.indx --
            self.savedIndex = this.indx;
            self.showSmoke();
                if(self.indx < 0){
                    self.indx = self.ImgNames.length -1;
                    self.savedIndex = self.indx;
                }
                self.selectThisElement();
                self.changeBgImage();
        });

        self.arrowDown.addEventListener("click", function(){
            self.deselectLastElement();
            self.indx ++
            self.savedIndex = self.indx;
            self.showSmoke();
                if(self.indx > self.ImgNames.length -1){
                    self.indx = 0;
                    self.savedIndex = self.indx;
                }
                self.selectThisElement();
                self.changeBgImage();
        });
    },

    changeBgImage : function(){
        this.Url.backgroundImage = "url('image/background/" + this.ImgNames[this.indx] + "')";
    },

    addNavIndexListenners : function(){
        const self = bg;
        this.navList.forEach(function(element, index){
            element.addEventListener("mouseenter",function(){
                self.deselectLastElement();
                self.indx = index;
                self.selectThisElement();
            });
            
            element.addEventListener("mouseleave",function(){
                self.deselectLastElement();
                self.indx = self.savedIndex;
                console.log(self.indx + " indx");
                self.selectThisElement();
            });

            element.addEventListener("click", function(){

                self.savedIndex = index;
                self.changeBgImage();
                bg.showSmoke();
            });
        });
    },

    showSmoke : function(){
        let element = this.smokeOverlayImg;
        let parent = element[0].parentElement;
        parent.innerHTML = "";
        element.forEach(function(element){
            parent.appendChild(element);
        });
        // important, had no choice to get rid of all elements in parent clone them et re append them becaus otherwise, i've seen that there is an problem with css animation
        //when you try to remove a class and re apply it to an element to re animate this element, its not stable. 
    },

    selectThisElement : function(){        
        let element = this.navSpanLines[this.indx]; 
        element.classList.add("hoveredLine");

        let state = this.navList[this.indx].firstElementChild;
        state.innerHTML = (this.indx + 1) + "/" + this.navList.length;
    },

    deselectLastElement : function(hoverIndex){
        let element = this.navSpanLines[this.indx]; 
        element.classList.remove("hoveredLine");

        let state = this.navList[this.indx].firstElementChild;
        state.innerHTML = "";
    },


};




    bg.selectThisElement();
    bg.initialiseListenners();


</script>


    <script src="script.js"></script>
</body>
</html>